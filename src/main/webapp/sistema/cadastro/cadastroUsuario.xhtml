<?xml version="1.0" encoding="UTF-8"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
				xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core" 
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:adm="http://github.com/adminfaces"
                template="/WEB-INF/templates/template.xhtml">
                
       <ui:define name="head-end">
	       <style type="text/css">
	            .ui-datatable .ui-datatable-header {
	                text-align: right !important;
	       }
	       </style>
    </ui:define>

    <ui:define name="title">
        Cadastro de Usuario
    </ui:define>

	<ui:define name="body">
		<adm:breadcrumb title="Cadastro de Usuario"/>
		<h:form id="frmList">
			<p:growl id="msgOk" showSummary="false" severity="info"/>
            <p:growl id="msgErro" showSummary="false" strick="true" severity="warn,error,fatal"/>
	        
		<div class="box box-primary">
        	<div class="box-header with-border">
				<div id="main-buttons" class="hidden-sm hidden-xs">
                        <p:commandButton icon="fa fa-plus"
                                         value="Novo" styleClass="btn-primary" 
                                         actionListener="#{usuarioControl.doStartAddRecord()}" 
                                         update="frmCadastro" />
                                         
                        <p:spacer width="5"/>
                        
                        <p:commandButton value="Excluir" icon="fa fa-trash" styleClass="btn-danger"
                                         action="#{usuarioControl.deleteRecord()}"
                                         actionListener="#{usuarioControl.unRowSelect()}"
                                         type="submit" update="frmList:tabela @(.ui-button)"
                                         disabled="#{usuarioControl.disableButton}">
                        	<p:confirm header="Confirmação" message="Você tem certeza que deseja excluir este item?" global="true" showEffect="fade" hideEffect="fade" styleClass="box-warning" />
                                <p:confirmDialog global="true" closable="true" closeOnEscape="true">
                                    <p:commandButton value="Sim" type="button" styleClass="btn-primary ui-confirmdialog-yes" icon="fa fa-check" />
                                    <p:commandButton value="Não" type="button" styleClass="btn-danger ui-confirmdialog-no" icon="fa fa-close" />
                        	</p:confirmDialog>
                        </p:commandButton>    
                                     
                        <p:spacer width="5"/>
                        
                        <p:commandButton value="Editar" update="@(.ui-dialog)" styleClass="btn-info"
                        				 disabled="#{usuarioControl.disableButton}"
                                         oncomplete="PF('dlgCadastro').show()" icon="fa fa-edit">
                        </p:commandButton>                 
                    </div>
                   
                    <p:separator/>

			<p:dataTable id="tabela" var="registro" value="#{usuarioControl.list}" rowKey="#{registro.id}" selectionMode="single" selection="#{usuarioControl.selected}"
							paginator="true" rows="10" paginatorPosition="bottom" paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="[ Página: {currentPage}/{totalPages} ]"
                                 widgetVar="wvTable">
							
                <p:ajax event="rowSelect" listener="#{usuarioControl.onRowSelect()}" update="@(.ui-button)"/>
                
                <p:column styleClass="align-center" width="5%">
                	<p:rowToggler />
                </p:column>

				<p:column headerText="Código" sortBy="#{registro.id}" filterBy="#{registro.id}" filterMatchMode="contains">
					<h:outputText value="#{registro.id}" />
				</p:column>

				<p:column headerText="Descrição" filterBy="#{registro.nome}" sortBy="#{registro.nome}" filterMatchMode="contains">
					<h:outputText value="#{registro.nome}" />
				</p:column>

				<p:column headerText="Ativo" sortBy="#{registro.ativo}"  filterBy="#{registro.ativo}" resizable="false" toggleable="true" style="text-align:center; padding: 0;">
					<f:facet id="idFilter" name="filter" >
	                    <p:selectOneButton onchange="PF('wvTable').filter()">
		                    <f:converter converterId="javax.faces.Boolean" />
		                    <f:selectItem itemLabel="Todos" itemValue="" />
		                    <f:selectItem itemLabel="Sim" itemValue="true" />
		                    <f:selectItem itemLabel="Não" itemValue="false" />
	                    </p:selectOneButton>
                    </f:facet>
				
					<p:graphicImage  value="#{utilityTela.getBooleanImg(registro.ativo)}"
                                     style="width: 25px;  height: 25px;" 
                                     alt="#{registro.ativo ? Não : Sim}" />
				</p:column>
				
				<p:rowExpansion>
	                <p:panelGrid  columns="2" style="width:100%"   >
		                	<h:outputText value="Código : "/>
		                <h:outputText value="#{registro.id}"  />
		                <h:outputText value="Descrição : " />
		                <h:outputText value="#{registro.nome}" />
						<h:outputText value="Ativo : " />
						<h:outputText value="#{utilityTela.getDescBoolean(registro.ativo)}" />
	                </p:panelGrid>
                </p:rowExpansion>

				<f:facet name="footer">
					Total: #{usuarioControl.list.size()}
				</f:facet>
			</p:dataTable>
			     </div>
            </div>
		</h:form>

		<p:dialog width="50%" height="auto" widgetVar="dlgCadastro" resizable="false" 
				header="Cadastro de Usuario" focus="frmCadastro:nome" styleClass="box-primary"
				modal="true" appendTo="@(body)" closable="true"   closeOnEscape="true">
			<h:form id="frmCadastro">
				<h:panelGrid columns="2" style="width:100%">
					<p:column width="50%">
						<p:outputLabel value="Código: "><br />
							<p:inputText value="#{usuarioControl.selected.id}" disabled="true"/>
						</p:outputLabel>
					</p:column>
					<p:column width="50%" style="text-align: left">
						<p:selectOneButton id="manyBtn" value="#{usuarioControl.selected.ativo}">
							<f:converter converterId="javax.faces.Boolean" />
	                        <f:selectItem itemLabel="Ativo" itemValue="true"/>
	                        <f:selectItem itemLabel="Inativo" itemValue="false"/>
                   		</p:selectOneButton>
                   	</p:column>	
                </h:panelGrid><br />

                <h:panelGrid columns="2" style="width:100%">
					<p:column width="100%" colspan="2">
						<p:outputLabel for="nome" value="Nome: " />
						<br />
						<p:inputText id="nome"
							value="#{usuarioControl.selected.nome}" required="true" style="width: 100%"/>
					</p:column>	
				</h:panelGrid><br />
				
				<h:panelGrid columns="2" style="width:100%">
					<p:column width="100%" colspan="2">
						<p:outputLabel for="email" value="Email: " />
						<br />
						<p:inputText id="email"
							value="#{usuarioControl.selected.email}" required="true" style="width: 100%"/>
					</p:column>	
				</h:panelGrid><br />
				
				<h:panelGrid columns="2" style="width:100%">
					<p:column width="50%">
						<p:outputLabel for="telefone" value="Telefone: " />
						<br />
						<p:inputText id="telefone"
							value="#{usuarioControl.selected.telefone}" required="true" style="width: 50%"/>
					</p:column>	
					<p:column width="50%">
						<p:outputLabel for="documento" value="Documento: " />
						<br />
						<p:inputText id="documento"
							value="#{usuarioControl.selected.documento}" required="true" style="width: 50%"/>
					</p:column>	
				</h:panelGrid><br />
				
				<h:panelGrid columns="2" style="width:100%">
					<p:column width="50%">
						<p:outputLabel for="senha" value="Senha: " />
						<br />
						<p:inputText id="senha"
							value="#{usuarioControl.selected.senha}" required="true" style="width: 50%"/>
					</p:column>	
					<p:column width="50%" style="text-align: left">
						<p:outputLabel for="manyBtnTipo" value="Tipo: " />
						<br />
						<p:selectOneButton id="manyBtnTipo" value="#{usuarioControl.selected.tipo}">
							<f:converter converterId="javax.faces.Integer" />
	                        <f:selectItem itemLabel="Admin" itemValue="1"/>
	                        <f:selectItem itemLabel="Usuario" itemValue="2"/>
	                        <f:selectItem itemLabel="Cliente" itemValue="3"/>
                   		</p:selectOneButton>
                   	</p:column>	
				</h:panelGrid>
				
				<p:separator/>
				<p:commandButton value="Salvar"
					style="margin-top: -10px; width: auto"
					update="frmList:tabela frmCadastro @(.ui-button)"
					action="#{usuarioControl.treatRecord()}"
					actionListener="#{usuarioControl.unRowSelect()}"
					type="submit"
					styleClass="btn-block btn-success" icon="fa fa-floppy-o"/>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>

